function initb1(){b1.y=-20,b1.x=-20-bloc1.width}function initb2(){b2.y=-20,b2.x=532}function initb3(){b3.y=256/3,b3.x=-20-bloc3.width}function initb4(){b4.y=276,b4.x=512/3}function initb5(){b5.y=276,b5.x=104}function initb6(){b6.y=276,b6.x=276}function initb7(){b7.y=276,b7.x=408}function initb8(){b8.y=276,b8.x=-20-bloc8.width}function initb9(){b9.y=0,b9.x=-20-bloc9.width}function initb10(){b10.y=256/3*2,b10.x=-20-bloc10.width}function initb11(){b11.y=-20-bloc11.height,b11.x=512/3*2}function initb12(){b12.y=-20-bloc12.height,b12.x=0}function initb13(){b13.y=256/3,b13.x=-20-bloc13.width}function initb14(){b14.y=256/3*2,b14.x=-20-bloc14.width}function initb15(){b15.y=-20-bloc15.height,b15.x=51}function initb16(){b16.y=-20-bloc16.height,b16.x=461}function initb17(){b17.y=-20-bloc17.height,b17.x=205}function initb18(){b18.y=-20-bloc18.height,b18.x=411}function initb19(){b19.y=200,b19.x=-20-bloc19.width}function initb20(){b20.y=276,b20.x=532}function initp1(){p1.x=(W-p1.w)/2,p1.y=(H-p1.h)/2}function initlB(){lB.y=10,lB.x=10}function initlBB(){lBB.x=490,lBB.y=10}function initBss(){bss.x=572,bss.y=28}function initLHand(){LHand.x=-150,LHand.y=-150}function initRHand(){RHand.x=-150,RHand.y=-150}function initMsl(){msl.x=-20,msl.y=-20}function initHB(){HB.x=246,HB.y=5}function initExp(){Exp.x=210,Exp.y=15}function initTitleS(){titleS.x=0,titleS.y=0}function initStart(){st.x=W/2-st.w/2,st.y=H/2+30}function initGameOver(){GmOv.x=0,GmOv.y=0}function initEndMessage(){EndMess.x=0,EndMess.y=0}function initCredits(){Crdts.x=0,Crdts.y=256}function spriteDimension(a,b){a.h=b.height,a.w=b.width}function curl(){curve+=.5,curve>180&&(curve=0)}function initCanvas(){CANVAS.width=W,CANVAS.height=H}function initPackOfSprite(){spriteDimension(p1,joueur),initp1(),spriteDimension(lB,lifeBar),initlB(),spriteDimension(bss,boss),initBss(),spriteDimension(lBB,lifeBarBoss),initlBB(),spriteDimension(LHand,leftHand),initLHand(),spriteDimension(RHand,rightHand),initRHand(),spriteDimension(msl,missile),initMsl(),spriteDimension(HB,heartboss),initHB(),spriteDimension(titleS,titlescreen),initTitleS(),spriteDimension(st,start),initStart(),spriteDimension(GmOv,gameover),initGameOver(),spriteDimension(EndMess,endingmessage),initEndMessage(),spriteDimension(Crdts,credits),initCredits();for(let i=1;i<21;i++){let fnName1="spriteDimension(b"+i+",bloc"+i+");",fnName2="initb"+i+"();";eval(fnName1),eval(fnName2)}}function initRestart(){spriteDimension(p1,joueur),initp1(),spriteDimension(bss,boss),initBss(),spriteDimension(LHand,leftHand),initLHand(),spriteDimension(RHand,rightHand),initRHand(),spriteDimension(lBB,lifeBarBoss),initlBB(),spriteDimension(msl,missile),initMsl(),spriteDimension(HB,heartboss),initHB(),spriteDimension(lB,lifeBar),initlB();for(let i=1;i<21;i++){let fnName1="spriteDimension(b"+i+",bloc"+i+");",fnName2="initb"+i+"();";eval(fnName1),eval(fnName2)}}function initVariousParameters(){mouseY=p1.y,mouseX=p1.x,canvas.addEventListener("mousemove",souris,!1),canvas.addEventListener("mousedown",getPosition,!1),document.body.style.cursor="none"}function travelArrowLeft(a){a.x+=2+counterP+counterMegaLoop}function travelArrowTop(a){a.y+=2+counterP+counterMegaLoop}function travelArrowBottom(a){a.y-=2+counterP+counterMegaLoop}function travelLaserLeft(a){a.x+=10+counterP+counterMegaLoop}function travelLaserTop(a){a.y+=5+counterP+counterMegaLoop}function travelLaserBottom(a){a.y-=5+counterP+counterMegaLoop}function travelSkullTL(){b1.x+=2+counterP+counterMegaLoop,b1.y+=1+(counterP+counterMegaLoop)/2}function travelSkullTR(){b2.x-=2+counterP+counterMegaLoop,b2.y+=1+(counterP+counterMegaLoop)/2}function travelSkullBottomLeft(){b8.x+=2+counterP+counterMegaLoop,b8.y-=1+(counterP+counterMegaLoop)/2}function travelCurlSkullLeft(){b19.x+=2+counterP+counterMegaLoop,b19.y+=(10+(counterP+counterMegaLoop)/2)*Math.sin(curve)}function travelCurlSkullBR(){b20.x-=2+counterP+counterMegaLoop,b20.y-=1+(10+(counterP+counterMegaLoop)/2)*Math.sin(curve)}function travelLaserH(){b3.x+=10+attackDifficult}function travelLaserV(){b4.y-=5+attackDifficult}function travelBossSkullL(){b1.x+=2+attackDifficult,b1.y+=1+attackDifficult+10*Math.sin(curve)}function travelBossSkullR(){b2.x-=2+attackDifficult,b2.y+=1+attackDifficult+10*Math.sin(curve)}function travelBossArrow(a){a.y+=2+attackDifficult}function souris(a){void 0!=a.x&&void 0!=a.y?(mouseX=((a.x-=canvas.offsetLeft) - 6),mouseY=((a.y-=canvas.offsetTop) - 7)):(mouseX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft-15,mouseY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop-15),p1.x=mouseX,p1.y=mouseY}function invulnerability(){snd=new Audio("sound/life-1.wav"),snd.play(),invulnerable=1,animInvulnerable=!0,setTimeout(function(){invulnerable=0,EndLevel||(joueur.src="img/heart.png"),EndLevel&&(joueur.src="img/heartTransform14.png"),0===lifeCounter&&(lifeBar.src="img/jauge_vide.png")},2e3)}function invulSystem(){1===invulnerable&&(EndLevel||(lifeCounter>0&&(GoInvul++,5===GoInvul&&(joueur.src="img/heartvide.png"),10===GoInvul&&(joueur.src="img/heart.png",GoInvul=0)),0===lifeCounter&&(joueur.src="img/heartvide.png")),EndLevel&&(lifeCounter>0&&(GoInvul++,5===GoInvul&&(joueur.src="img/heartvide.png"),10===GoInvul&&(joueur.src="img/heartTransform14.png",GoInvul=0)),0===lifeCounter&&(joueur.src="img/heartvide.png")))}function collisions(a,b){return!(a.y+a.h<b.y||a.y>b.y+b.h||a.x>b.x+b.w||a.x+a.w<b.x)}function collisionEffect(a){collisions(a,p1)&&0===invulnerable&&lifeCounter>0&&(lifeCounter--,a.w=0,a.h=0,invulnerability())}function bossCollisionEffect(a){collisions(a,p1)&&0===invulnerable&&(lifeCounter--,invulnerability())}function bossDamage(){collisions(msl,HB)&&(bosslifeCounter--,HB.y-=3,setTimeout(function(){HB.y+=3},200),snd=new Audio("sound/heartbosstouched.wav"),snd.play(),bosslifeCounter>0&&(lifeBarBoss.src="img/lifeboss"+(20-bosslifeCounter)+".png"),0===bosslifeCounter&&(HB.src="",startBattle=-20),msl.y=-11)}function packOfCollisionEffect(){for(let i=1;i<21;i++){let fnName="collisionEffect(b"+i+");";eval(fnName)}}function packOfBossCollisionEffect(){bossDamage(),bossCollisionEffect(bss),bossCollisionEffect(HB),bossCollisionEffect(LHand),bossCollisionEffect(RHand)}function collisionManager(){packOfCollisionEffect(),packOfBossCollisionEffect()}function lifeCounterEffect(){2===lifeCounter&&(lifeBar.src="img/jauge_demi1.png"),1===lifeCounter&&(lifeBar.src="img/jauge_demi2.png"),0===lifeCounter&&(lifeBar.src="img/jauge_vide.png"),lifeCounter<=0&&(joueur.src="img/heartvide.png")}function soundEffect(){EndLevel||sndLevel.addEventListener("ended",function(){this.currentTime=0,this.play()},!1)}function bossLauncher(){if(bss.x>226&&(20===TimerBoss&&(boss.src="img/boss_normal.png"),40===TimerBoss&&(boss.src="img/boss_normal1.png",TimerBoss=0),bss.x-=2,226===bss.x)){let a=new Audio("sound/sf_diable_10.mp3");a.play(),setTimeout(function(){boucleMusicBoss||(musicBoss.play(),boucleMusicboss=!0)},4e3)}226===bss.x&&(jaugeBoss(),annexTimerBoss()),225===bss.x&&0===startBattle&&(eventHeartBoss=!0,startBattle=1)}function AnimHeart(){TimerHeart++,TimerHeart%20===0&&(joueur.src="img/heartTransform"+loopCount+".png",loopCount++,20===TimerHeart&&(invulnerable=2),280===TimerHeart&&(EndAnimHeart=!0,invulnerable=0,loopCount=1))}function jaugeBoss(){TimerJaugeBoss<231&&(TimerJaugeBoss++,TimerJaugeBoss%10===0&&(lifeBarBoss.src="img/jaugeboss"+jaugeCount+".png",jaugeCount--,230===TimerJaugeBoss&&(lifeBarBoss.src="img/jaugeboss_remplie.png")))}function annexTimerBoss(){TimerBoss1++,10===TimerBoss1&&(boss.src="img/boss_normal.png"),20===TimerBoss1&&(boss.src="img/boss_normal1.png",TimerBoss1=0),setTimeout(function(){226===bss.x&&(bss.x--,TimerBoss1=0)},3e3)}function stopSoundLevel(){sndLevel.pause(),sndLevel.currentTime=0}function launchAnimHeart(){EndAnimHeart||AnimHeart()}function bossLeveling(){bosslifeCounter>10&&bosslifeCounter<=15&&(attackDifficult=.5),bosslifeCounter>5&&bosslifeCounter<=10&&(attackDifficult=1),bosslifeCounter>0&&bosslifeCounter<=5&&(attackDifficult=1.5)}function bossAttackPattern(){225===bss.x&&1===startBattle&&(attackChoice(),attackRandom>=0&&attackRandom<=49&&(LHandAnim(),LHandAttackPattern()),attackRandom>=50&&attackRandom<=100&&(RHandAnim(),RHandAttackPattern()))}function movingBossHeart(){eventHeartBoss&&(heartboss.src="img/heartboss.png",spriteDimension(HB,heartboss),HB.x<465&&0===invertHeartBoss&&(HB.x+=2,466===HB.x&&(invertHeartBoss=1)),HB.x>30&&1===invertHeartBoss&&(HB.x-=2,30===HB.x&&(invertHeartBoss=0)))}function initRestartSwitcher(){eventHeartBoss=!1,animInvulnerable=!1,EndAnimHeart=!1,testlaser1=!1,testLHand=!1,arrowtest=!1,testRHand=!1,patternLeftHandGo=!1,patternRightHandGo=!1,bossAttackGo=!1,startAnimExplo=!0,Phase1=!0,Phase2=!1,Phase3=!1,Phase4=!1,b1EndAnim=!1,b2EndAnim=!1,b3EndAnim=!0,b4EndAnim=!0,b5EndAnim=!0,b6EndAnim=!0,b7EndAnim=!0,b8EndAnim=!0,b9EndAnim=!0,b10EndAnim=!0,b11EndAnim=!0,b12EndAnim=!0,b13EndAnim=!0,b14EndAnim=!0,b15EndAnim=!0,b16EndAnim=!0,b17EndAnim=!0,b18EndAnim=!0,b19EndAnim=!0,b20EndAnim=!0}function initRestartCounter(){startBattle=0,invertHeartBoss=0,TimerJaugeBoss=0,invulnerable=0,TimerHeart=0,TimerBoss=0,TimerBoss1=0,GoInvul=0,fire=0,invertedLHand=0,invertedRHand=0,attackRandom=0,attackDifficult=0,animExplo=0,Click_x=0,Click_y=0,curve=0,counterP=0,counterMegaLoop=1,loopCount=1,lifeCounter=3,bosslifeCounter=20,jaugeCount=22}function initRestartVar(){initRestartSwitcher(),initRestartCounter()}function initRestartSprite(){joueur.src="img/heart.png",background.src="img/background.png",lifeBar.src="img/jauge_remplie.png",bloc1.src="img/skull.png",bloc2.src="img/skull.png",bloc3.src="img/rayonH.png",bloc4.src="img/rayon.png",bloc5.src="img/arrowup.png",bloc6.src="img/arrowup.png",bloc7.src="img/arrowup.png",bloc8.src="img/skull.png",bloc9.src="img/rayonH.png",bloc10.src="img/rayonH.png",bloc11.src="img/rayon.png",bloc12.src="img/rayon.png",bloc13.src="img/arrowright.png",bloc14.src="img/arrowright.png",bloc15.src="img/arrowdown.png",bloc16.src="img/arrowdown.png",bloc17.src="img/arrowdown.png",bloc18.src="img/arrowdown.png",bloc19.src="img/skull.png",bloc20.src="img/skull.png",leftHand.src="",rightHand.src="",gameover.src="img/gameoverScreen.png",heartboss.src=""}function getPosition(a){Click_x=a.x,Click_y=a.y,Click_x-=canvas.offsetLeft,Click_y-=canvas.offsetTop,collisions(st,p1)&&!startEvent&&(clickStart=!0),lifeCounter<=0&&(initRestart(),initRestartVar(),initRestartSprite()),0===fire&&(fire=1)}function shootManager(){getPosition&&1===fire&&(missile.src="img/missile.png",spriteDimension(msl,missile),msl.x=Click_x,msl.y=Click_y,fire=2),2===fire&&(msl.y-=3),msl.y<-10&&(fire=0)}function AnimExplo(){sndExplostart||(sndExplo.play(),sndExplostart=!0),animExplo++,animExplo%5===0&&animExplo<56&&(explosion.src="img/explo"+loopCount+".png",loopCount++,25===animExplo&&(boss.src=""),55===animExplo&&(explosion.src="",startAnimExplo=!1))}function bossDeath(){startBattle===-20&&(eventHeartBoss=!1,heartboss.src="",spriteDimension(Exp,explosion),initExp(),startAnimExplo&&AnimExplo())}function victoryEnding(){startAnimExplo||(musicBoss.pause(),musicBoss.currentTime=0,musicEnding.play(),p1.w=0,p1.h=0,p1.x=1e4,p1.y=1e4,launchEndingMessage=!0,launchEndingMessage&&EndMess.y!=-744&&(EndMess.y-=.4),launchEndingMessage&&EndMess.y<=-742&&(launchCredits=!0),launchCredits&&Crdts.y>-2244&&(Crdts.y-=.4))}function bossBattle(){stopSoundLevel(),launchAnimHeart(),shootManager(),bossLauncher(),bossLeveling(),bossDeath(),bossAttackPattern(),movingBossHeart(),victoryEnding()}function gameLauncher(){clickStart&&(startEvent=!0,clickStart=!1,titlescreen.src="",start.src="")}function Game(){startEvent&&(soundEffect(),curl(),lifeCounterEffect(),invulSystem(),gamePattern())}
